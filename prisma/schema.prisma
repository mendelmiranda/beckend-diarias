generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model bancos {
  cod   Int     @id @default(autoincrement())
  banco String? @db.VarChar(120)
}

model conta_diaria {
  id      Int    @id @default(autoincrement())
  nome    String @db.VarChar(20)
  cpf     String @db.VarChar(20)
  tipo    String @db.Char(1)
  agencia String @db.VarChar(20)
  conta   String @db.VarChar(20)
}

model pais {
  id      Int     @id @default(autoincrement())
  nome    String? @db.VarChar(60)
  nome_pt String? @db.VarChar(60)
  sigla   String? @db.VarChar(2)
  bacen   Int?
}

model tipo_evento {
  id        Int      @id @unique @default(autoincrement())
  descricao String?  @db.VarChar(60)
  eventos   evento[]
}

model estado {
  id           Int            @id @default(autoincrement())
  descricao    String         @db.VarChar(50)
  uf           String         @db.Char(2)
  cidade       cidade[]
  participante participante[]
}

model cidade {
  id        Int    @unique @default(autoincrement())
  estado_id Int
  descricao String @db.VarChar(50)
  estado    estado @relation(fields: [estado_id], references: [id])

  eventos evento[]
  origem  viagem[] @relation("ori")
  destino viagem[] @relation("dest")

  @@id([id, estado_id])
}

model solicitacao {
  id            Int      @default(autoincrement())
  datareg       DateTime @default(now())
  justificativa String   @db.VarChar(250)
  eventos       evento[]

  @@id([id])
}

model evento {
  id             Int         @default(autoincrement())
  tipo_evento_id Int
  tipo_evento    tipo_evento @relation(fields: [tipo_evento_id], references: [id])
  solicitacao_id Int
  solicitacao    solicitacao @relation(fields: [solicitacao_id], references: [id])
  titulo         String
  inicio         DateTime
  fim            DateTime
  exterior       String
  local_exterior String?
  cidade_id      Int?
  cidade         cidade?     @relation(fields: [cidade_id], references: [id])
  informacoes    String

  evento_participantes evento_participantes[]

  @@id([id])
}

model participante {
  id              Int      @id @default(autoincrement())
  nome            String
  cpf             String
  data_nascimento DateTime
  matricula       Int?
  lotacao         String?
  tipo            String   @db.Char(1)

  estado_id Int?
  estado    estado? @relation(fields: [estado_id], references: [id])
  cep String?
  endereco String?
  recebe_diarias_na_origem String? @db.Char(1)

  evento_participantes evento_participantes[]
}

model evento_participantes {
  evento_id Int
  evento    evento @relation(fields: [evento_id], references: [id])

  participante_id Int
  participante    participante @relation(fields: [participante_id], references: [id])

  @@id([evento_id, participante_id])
}

model viagem {
  id        Int    @id @default(autoincrement())
  origem_id Int
  origem    cidade @relation("ori", fields: [origem_id], references: [id])

  destino_id Int
  destino    cidade @relation("dest", fields: [destino_id], references: [id])

  trecho        String
  data_ida      DateTime
  data_volta    DateTime?
  justificativa String?
  datareg       DateTime  @default(now())
}
